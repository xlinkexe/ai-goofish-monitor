# é—²é±¼æ™ºèƒ½ç›‘æ§æœºå™¨äºº

ä¸€ä¸ªåŸºäº Playwright å’ŒAIè¿‡æ»¤åˆ†æçš„é—²é±¼å¤šä»»åŠ¡å®æ—¶ç›‘æ§ä¸æ™ºèƒ½åˆ†æå·¥å…·ï¼Œé…å¤‡äº†åŠŸèƒ½å®Œå–„çš„ Web ç®¡ç†ç•Œé¢ã€‚

## âœ¨ é¡¹ç›®äº®ç‚¹

- **å¯è§†åŒ–Webç•Œé¢**: æä¾›å®Œæ•´çš„Web UIï¼Œæ”¯æŒä»»åŠ¡çš„å¯è§†åŒ–ç®¡ç†ã€AIæ ‡å‡†åœ¨çº¿ç¼–è¾‘ã€è¿è¡Œæ—¥å¿—å®æ—¶æŸ¥çœ‹å’Œç»“æœç­›é€‰æµè§ˆï¼Œæ— éœ€ç›´æ¥æ“ä½œå‘½ä»¤è¡Œå’Œé…ç½®æ–‡ä»¶ã€‚
- **AIé©±åŠ¨çš„ä»»åŠ¡åˆ›å»º**: åªéœ€ç”¨è‡ªç„¶è¯­è¨€æè¿°ä½ çš„è´­ä¹°éœ€æ±‚ï¼Œå³å¯ä¸€é”®åˆ›å»ºåŒ…å«å¤æ‚ç­›é€‰é€»è¾‘çš„å…¨æ–°ç›‘æ§ä»»åŠ¡ã€‚
- **å¤šä»»åŠ¡å¹¶å‘**: é€šè¿‡ `config.json` åŒæ—¶ç›‘æ§å¤šä¸ªå…³é”®è¯ï¼Œå„ä»»åŠ¡ç‹¬ç«‹è¿è¡Œï¼Œäº’ä¸å¹²æ‰°ã€‚
- **å®æ—¶æµå¼å¤„ç†**: å‘ç°æ–°å•†å“åï¼Œç«‹å³è¿›å…¥åˆ†ææµç¨‹ï¼Œå‘Šåˆ«æ‰¹å¤„ç†å»¶è¿Ÿã€‚
- **æ·±åº¦AIåˆ†æ**: é›†æˆå¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ GPT-4oï¼‰ï¼Œç»“åˆå•†å“å›¾æ–‡å’Œå–å®¶ç”»åƒè¿›è¡Œæ·±åº¦åˆ†æï¼Œç²¾å‡†ç­›é€‰ã€‚
- **é«˜åº¦å¯å®šåˆ¶**: æ¯ä¸ªç›‘æ§ä»»åŠ¡å‡å¯é…ç½®ç‹¬ç«‹çš„å…³é”®è¯ã€ä»·æ ¼èŒƒå›´ã€ç­›é€‰æ¡ä»¶å’ŒAIåˆ†ææŒ‡ä»¤ (Prompt)ã€‚
- **å³æ—¶é€šçŸ¥**: é€šè¿‡ [ntfy.sh](https://ntfy.sh/) å°†ç¬¦åˆAIæ¨èçš„å•†å“ç«‹å³æ¨é€åˆ°ä½ çš„æ‰‹æœºæˆ–æ¡Œé¢ã€‚
- **å¥å£®çš„åçˆ¬ç­–ç•¥**: æ¨¡æ‹ŸçœŸäººæ“ä½œï¼ŒåŒ…å«å¤šç§éšæœºå»¶è¿Ÿå’Œç”¨æˆ·è¡Œä¸ºï¼Œæé«˜ç¨³å®šæ€§ã€‚

## é¡µé¢æˆªå›¾
åå°ä»»åŠ¡ç®¡ç†
![img.png](img.png)

åå°ç›‘æ§æˆªå›¾
![img_1.png](img_1.png)

ntfé€šçŸ¥æˆªå›¾
![img_2.png](img_2.png)

## ğŸš€ å¿«é€Ÿå¼€å§‹ (Web UI æ¨è)

æ¨èä½¿ç”¨ Web ç®¡ç†ç•Œé¢æ¥æ“ä½œæœ¬é¡¹ç›®ï¼Œä½“éªŒæœ€ä½³ã€‚

### ç¬¬ 1 æ­¥: ç¯å¢ƒå‡†å¤‡

å…‹éš†æœ¬é¡¹ç›®åˆ°æœ¬åœ°:
```bash
git clone https://github.com/dingyufei615/ai-goofish-monitor
cd ai-goofish-monitor
```

å®‰è£…æ‰€éœ€çš„Pythonä¾èµ–ï¼š
```bash
pip install -r requirements.txt
```

### ç¬¬ 2 æ­¥: åŸºç¡€é…ç½®

1.  **é…ç½®ç¯å¢ƒå˜é‡**: åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª `.env` æ–‡ä»¶ï¼Œå¹¶å¡«å…¥ä»¥ä¸‹é…ç½®ä¿¡æ¯ã€‚
    ```env
    # --- AI æ¨¡å‹ç›¸å…³é…ç½® ---
    # æ¨¡å‹çš„API Keyã€‚
    OPENAI_API_KEY="sk-..."
    
    # æ¨¡å‹çš„APIæ¥å£åœ°å€ã€‚è¿™é‡Œéœ€è¦å¡«å†™æœåŠ¡å•†æä¾›çš„ã€å…¼å®¹OpenAIæ ¼å¼çš„APIåœ°å€ï¼ŒåŸºæœ¬æ‰€æœ‰æ¨¡å‹éƒ½æœ‰æä¾›OpenAIæ ¼å¼å…¼å®¹çš„æ¥å£
    # å¯æŸ¥é˜…ä½ ä½¿ç”¨çš„å¤§æ¨¡å‹APIæ–‡æ¡£ï¼Œå¦‚æ ¼å¼ä¸º https://xx.xx.com/v1/chat/completions åˆ™OPENAI_BASE_URLåªéœ€è¦å¡«å…¥å‰åŠæ®µ https://xx.xx.com/v1/
    OPENAI_BASE_URL="https://generativelanguage.googleapis.com/v1beta/openai/"
    
    # ä½¿ç”¨çš„æ¨¡å‹åç§°ï¼Œæ¨¡å‹éœ€è¦æ”¯æŒå›¾ç‰‡ä¸Šä¼ ã€‚
    OPENAI_MODEL_NAME="gemini-2.5-pro"

    # ntfy é€šçŸ¥æœåŠ¡é…ç½®
    NTFY_TOPIC_URL="https://ntfy.sh/your-topic-name" # æ›¿æ¢ä¸ºä½ çš„ ntfy ä¸»é¢˜ URL
    
    # ä¼ä¸šå¾®ä¿¡æœºå™¨äººé€šçŸ¥é…ç½® å¦‚æœæ— åˆ™ä¸ç”¨é…ç½®
    WX_BOT_URL="https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxxx"

    # æ˜¯å¦ä½¿ç”¨edgeæµè§ˆå™¨ é»˜è®¤ä½¿ç”¨chromeæµè§ˆå™¨
    LOGIN_IS_EDGE=false
    
    # æ˜¯å¦å¼€å¯ç”µè„‘é“¾æ¥è½¬æ¢ä¸ºæ‰‹æœºé“¾æ¥
    PCURL_TO_MOBILE=true
    
    # çˆ¬è™«æ˜¯å¦ä»¥æ— å¤´æ¨¡å¼è¿è¡Œ (true/false)ã€‚é‡åˆ°æ»‘åŠ¨éªŒè¯ç æ—¶ï¼Œå¯è®¾ä¸º false 
    RUN_HEADLESS=true
    ```

2.  **è·å–ç™»å½•çŠ¶æ€ (é‡è¦!)**: ä¸ºäº†è®©çˆ¬è™«èƒ½å¤Ÿä»¥ç™»å½•çŠ¶æ€è®¿é—®é—²é±¼ï¼Œ**å¿…é¡»å…ˆè¿è¡Œä¸€æ¬¡ç™»å½•è„šæœ¬**ä»¥ç”Ÿæˆä¼šè¯çŠ¶æ€æ–‡ä»¶ã€‚
    ```bash
    python login.py
    ```
    è¿è¡Œåä¼šå¼¹å‡ºä¸€ä¸ªæµè§ˆå™¨çª—å£ï¼Œè¯·ä½¿ç”¨**æ‰‹æœºé—²é±¼Appæ‰«æäºŒç»´ç **å®Œæˆç™»å½•ã€‚æˆåŠŸåï¼Œç¨‹åºä¼šè‡ªåŠ¨å…³é—­ï¼Œå¹¶åœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª `xianyu_state.json` æ–‡ä»¶ã€‚

### ç¬¬ 3 æ­¥: å¯åŠ¨ Web æœåŠ¡

ä¸€åˆ‡å°±ç»ªåï¼Œå¯åŠ¨ Web ç®¡ç†åå°æœåŠ¡å™¨ã€‚
```bash
python web_server.py
```

### ç¬¬ 4 æ­¥: å¼€å§‹ä½¿ç”¨

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://127.0.0.1:8000` è®¿é—®ç®¡ç†åå°ã€‚

1.  åœ¨ **â€œä»»åŠ¡ç®¡ç†â€** é¡µé¢ï¼Œç‚¹å‡» **â€œåˆ›å»ºæ–°ä»»åŠ¡â€**ã€‚
2.  åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œç”¨è‡ªç„¶è¯­è¨€æè¿°ä½ çš„è´­ä¹°éœ€æ±‚ï¼ˆä¾‹å¦‚ï¼šâ€œæˆ‘æƒ³ä¹°ä¸€å°95æ–°ä»¥ä¸Šçš„ç´¢å°¼A7M4ç›¸æœºï¼Œé¢„ç®—1ä¸‡3ä»¥å†…ï¼Œå¿«é—¨æ•°ä½äº5000â€ï¼‰ï¼Œå¹¶å¡«å†™ä»»åŠ¡åç§°ã€å…³é”®è¯ç­‰ä¿¡æ¯ã€‚
3.  ç‚¹å‡»åˆ›å»ºï¼ŒAIå°†è‡ªåŠ¨ä¸ºä½ ç”Ÿæˆä¸€å¥—å¤æ‚çš„åˆ†ææ ‡å‡†ã€‚
4.  å›åˆ°ä¸»ç•Œé¢ï¼Œç‚¹å‡»å³ä¸Šè§’çš„ **â€œğŸš€ å…¨éƒ¨å¯åŠ¨â€**ï¼Œå¼€å§‹äº«å—è‡ªåŠ¨åŒ–ç›‘æ§ï¼

## ğŸ“¸ Web UI åŠŸèƒ½ä¸€è§ˆ

-   **ä»»åŠ¡ç®¡ç†**:
    -   **AIåˆ›å»ºä»»åŠ¡**: ä½¿ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼Œä¸€é”®ç”Ÿæˆç›‘æ§ä»»åŠ¡å’Œé…å¥—AIåˆ†ææ ‡å‡†ã€‚
    -   **å¯è§†åŒ–ç¼–è¾‘**: åœ¨è¡¨æ ¼ä¸­ç›´æ¥ä¿®æ”¹ä»»åŠ¡å‚æ•°ï¼Œå¦‚å…³é”®è¯ã€ä»·æ ¼èŒƒå›´ç­‰ã€‚
    -   **å¯åœæ§åˆ¶**: ç‹¬ç«‹æ§åˆ¶æ¯ä¸ªä»»åŠ¡çš„å¯ç”¨/ç¦ç”¨çŠ¶æ€ï¼Œæˆ–ä¸€é”®å¯åœæ‰€æœ‰ä»»åŠ¡ã€‚
-   **ç»“æœæŸ¥çœ‹**:
    -   **å¡ç‰‡å¼æµè§ˆ**: ä»¥å›¾æ–‡å¡ç‰‡å½¢å¼æ¸…æ™°å±•ç¤ºæ¯ä¸ªç¬¦åˆæ¡ä»¶çš„å•†å“ã€‚
    -   **æ™ºèƒ½ç­›é€‰**: å¯ä¸€é”®ç­›é€‰å‡ºæ‰€æœ‰è¢«AIæ ‡è®°ä¸ºâ€œæ¨èâ€çš„å•†å“ã€‚
    -   **æ·±åº¦è¯¦æƒ…**: æŸ¥çœ‹æ¯ä¸ªå•†å“çš„å®Œæ•´æŠ“å–æ•°æ®å’ŒAIåˆ†æçš„è¯¦ç»†JSONç»“æœã€‚
-   **è¿è¡Œæ—¥å¿—**:
    -   **å®æ—¶æ—¥å¿—æµ**: åœ¨ç½‘é¡µä¸Šå®æ—¶æŸ¥çœ‹çˆ¬è™«è¿è¡Œçš„è¯¦ç»†æ—¥å¿—ï¼Œæ–¹ä¾¿è¿½è¸ªè¿›åº¦å’Œæ’æŸ¥é—®é¢˜ã€‚
-   **ç³»ç»Ÿè®¾ç½®**:
    -   **çŠ¶æ€æ£€æŸ¥**: ä¸€é”®æ£€æŸ¥ `.env` é…ç½®ã€ç™»å½•çŠ¶æ€ç­‰å…³é”®ä¾èµ–æ˜¯å¦æ­£å¸¸ã€‚
    -   **Promptåœ¨çº¿ç¼–è¾‘**: ç›´æ¥åœ¨ç½‘é¡µä¸Šç¼–è¾‘å’Œä¿å­˜ç”¨äºAIåˆ†æçš„ `prompt` æ–‡ä»¶ï¼Œå®æ—¶è°ƒæ•´AIçš„æ€è€ƒé€»è¾‘ã€‚

## âš™ï¸ å‘½ä»¤è¡Œé«˜çº§ç”¨æ³•

å¯¹äºå–œæ¬¢å‘½ä»¤è¡Œçš„ç”¨æˆ·ï¼Œé¡¹ç›®åŒæ ·ä¿ç•™äº†è„šæœ¬ç‹¬ç«‹è¿è¡Œçš„èƒ½åŠ›ã€‚

### å¯åŠ¨ç›‘æ§

ç›´æ¥è¿è¡Œä¸»çˆ¬è™«è„šæœ¬ï¼Œå®ƒä¼šåŠ è½½ `config.json` ä¸­æ‰€æœ‰å¯ç”¨çš„ä»»åŠ¡ã€‚
```bash
python spider_v2.py
```
**è°ƒè¯•æ¨¡å¼**: å¦‚æœåªæƒ³æµ‹è¯•å°‘é‡å•†å“ï¼Œå¯ä»¥ä½¿ç”¨ `--debug-limit` å‚æ•°ã€‚
```bash
# æ¯ä¸ªä»»åŠ¡åªå¤„ç†å‰2ä¸ªæ–°å‘ç°çš„å•†å“
python spider_v2.py --debug-limit 2
```

### é€šè¿‡è„šæœ¬åˆ›å»ºæ–°ä»»åŠ¡

`prompt_generator.py` è„šæœ¬å¯ä»¥è®©ä½ é€šè¿‡å‘½ä»¤è¡Œå¿«é€Ÿåˆ›å»ºæ–°ä»»åŠ¡ã€‚
```bash
python prompt_generator.py \
  --description "æˆ‘æƒ³ä¹°ä¸€å°95æ–°ä»¥ä¸Šçš„ç´¢å°¼A7M4ç›¸æœºï¼Œé¢„ç®—åœ¨10000åˆ°13000å…ƒä¹‹é—´ï¼Œå¿«é—¨æ•°è¦ä½äº5000ã€‚å¿…é¡»æ˜¯å›½è¡Œä¸”é…ä»¶é½å…¨ã€‚ä¼˜å…ˆè€ƒè™‘ä¸ªäººå–å®¶ï¼Œä¸æ¥å—å•†å®¶æˆ–è´©å­ã€‚" \
  --output prompts/sony_a7m4_criteria.txt \
  --task-name "Sony A7M4" \
  --keyword "a7m4" \
  --min-price "10000" \
  --max-price "13000"
```
æ‰§è¡Œåï¼Œå®ƒä¼šè‡ªåŠ¨åˆ›å»ºæ–°çš„ `_criteria.txt` æ–‡ä»¶ï¼Œå¹¶åœ¨ `config.json` ä¸­æ·»åŠ å¹¶å¯ç”¨å¯¹åº”çš„æ–°ä»»åŠ¡ã€‚

## ğŸš€ å·¥ä½œæµç¨‹

```mermaid
graph TD
    A[å¯åŠ¨ä¸»ç¨‹åº] --> B{è¯»å– config.json};
    B --> C{å¹¶å‘å¯åŠ¨å¤šä¸ªç›‘æ§ä»»åŠ¡};
    C --> D[ä»»åŠ¡: æœç´¢å•†å“];
    D --> E{å‘ç°æ–°å•†å“?};
    E -- æ˜¯ --> F[æŠ“å–å•†å“è¯¦æƒ… & å–å®¶ä¿¡æ¯];
    F --> G[ä¸‹è½½å•†å“å›¾ç‰‡];
    G --> H[è°ƒç”¨AIè¿›è¡Œåˆ†æ];
    H --> I{AIæ˜¯å¦æ¨è?};
    I -- æ˜¯ --> J[å‘é€ ntfy é€šçŸ¥];
    J --> K[ä¿å­˜è®°å½•åˆ° JSONL];
    I -- å¦ --> K;
    E -- å¦ --> L[ç¿»é¡µ/ç­‰å¾…];
    L --> D;
    K --> E;
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **æ ¸å¿ƒæ¡†æ¶**: Playwright (å¼‚æ­¥) + asyncio
- **WebæœåŠ¡**: FastAPI
- **AI æ¨¡å‹**: OpenAI API (æ”¯æŒ GPT-4o ç­‰å¤šæ¨¡æ€æ¨¡å‹)
- **é€šçŸ¥æœåŠ¡**: ntfy
- **é…ç½®ç®¡ç†**: JSON
- **ä¾èµ–ç®¡ç†**: pip

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ .env                # ç¯å¢ƒå˜é‡ï¼Œå­˜æ”¾APIå¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯
â”œâ”€â”€ .gitignore          # Gitå¿½ç•¥é…ç½®
â”œâ”€â”€ config.json         # æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰æ‰€æœ‰ç›‘æ§ä»»åŠ¡
â”œâ”€â”€ login.py            # é¦–æ¬¡è¿è¡Œå¿…é¡»æ‰§è¡Œï¼Œç”¨äºè·å–å¹¶ä¿å­˜ç™»å½•Cookie
â”œâ”€â”€ spider_v2.py        # æ ¸å¿ƒçˆ¬è™«ç¨‹åº
â”œâ”€â”€ prompt_generator.py # AIåˆ†ææ ‡å‡†ç”Ÿæˆè„šæœ¬
â”œâ”€â”€ web_server.py       # WebæœåŠ¡ä¸»ç¨‹åº
â”œâ”€â”€ requirements.txt    # Pythonä¾èµ–åº“
â”œâ”€â”€ README.md           # å°±æ˜¯ä½ æ­£åœ¨çœ‹çš„è¿™ä¸ªæ–‡ä»¶
â”œâ”€â”€ prompts/            # å­˜æ”¾ä¸åŒä»»åŠ¡çš„AIåˆ†ææŒ‡ä»¤(Prompt)
â”‚   â”œâ”€â”€ base_prompt.txt
â”‚   â””â”€â”€ ..._criteria.txt
â”œâ”€â”€ static/             # Webå‰ç«¯é™æ€æ–‡ä»¶
â”‚   â”œâ”€â”€ css/style.css
â”‚   â””â”€â”€ js/main.js
â”œâ”€â”€ templates/          # Webå‰ç«¯æ¨¡æ¿
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ images/             # (è‡ªåŠ¨åˆ›å»º) å­˜æ”¾ä¸‹è½½çš„å•†å“å›¾ç‰‡
â”œâ”€â”€ logs/               # (è‡ªåŠ¨åˆ›å»º) å­˜æ”¾è¿è¡Œæ—¥å¿—
â””â”€â”€ *.jsonl             # (è‡ªåŠ¨åˆ›å»º) å­˜æ”¾æ¯ä¸ªä»»åŠ¡çš„æŠ“å–å’Œåˆ†æç»“æœ
```

## è‡´è°¢

æœ¬é¡¹ç›®åœ¨å¼€å‘è¿‡ç¨‹ä¸­å‚è€ƒäº†ä»¥ä¸‹ä¼˜ç§€é¡¹ç›®ï¼Œç‰¹æ­¤æ„Ÿè°¢ï¼š
- [superboyyy/xianyu_spider](https://github.com/superboyyy/xianyu_spider)

ä»¥åŠæ„Ÿè°¢LinuxDoç›¸å…³ä½¬å‹çš„è„šæœ¬è´¡çŒ®
- [@jooooody](https://linux.do/u/jooooody/summary)

ä»¥åŠæ„Ÿè°¢Aiderå’ŒGemini è§£æ”¾åŒæ‰‹ï¼Œä»£ç å†™èµ·æ¥é£ä¸€èˆ¬çš„æ„Ÿè§‰ï½

## âš ï¸ æ³¨æ„äº‹é¡¹

- è¯·éµå®ˆé—²é±¼çš„ç”¨æˆ·åè®®å’Œrobots.txtè§„åˆ™ï¼Œä¸è¦è¿›è¡Œè¿‡äºé¢‘ç¹çš„è¯·æ±‚ï¼Œä»¥å…å¯¹æœåŠ¡å™¨é€ æˆè´Ÿæ‹…æˆ–å¯¼è‡´è´¦å·è¢«é™åˆ¶ã€‚
- æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’ŒæŠ€æœ¯ç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚

[![Star History Chart](https://api.star-history.com/svg?repos=dingyufei615/ai-goofish-monitor&type=Date)](https://star-history.com/#dingyufei615/ai-goofish-monitor&Date)
